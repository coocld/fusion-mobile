"use strict";define("common/touchslider/touchslider",["common/pointerevents/pointerevents"],function(t){function e(t,e){var n,i;e?(n=Math.round(Math.sqrt(-1*t.subcontainer.offsetLeft/t.container.clientWidth)*t.duration),i=0):(n=Math.round(Math.sqrt((t.container.offsetWidth+t.subcontainer.offsetLeft)/t.container.clientWidth)*t.duration),i="-100%"),n>0?(t.sliding=!0,t.subcontainer.style[g]="left "+n+"ms ease-in-out",t.subcontainer.style.left=i):d(t)}function n(t,e){if(t.target===this){for(e.invisible.appendChild("-100%"===this.style.left?this.firstChild:this.lastChild),this.style[g]="",this.style.left=0,e.sliding=!1;e.removeStack.length>0;)e.remove(e.removeStack.shift());for(;e.pushStack.length>0;)e.add(e.pushStack.shift());a(e,"slidend"),d(e)}}function i(t,e,n,i){if("start"===t.type){if(!n.pointers.length&&e.children.length>1&&!e.sliding)return e.timer&&(clearTimeout(e.timer),delete e.timer),i.ox=i.nx=i.x=t.x,i.ot=i.nt=t.domEvent.timeStamp,i.sl=function(t){document.removeEventListener("scroll",i.sl,!0),delete i.sl},document.addEventListener("scroll",i.sl,!0),!0}else(e.moving||i.sl)&&("move"===t.type?r(t,e,i):"end"===t.type?s(t,e,i):o(e,i))}function r(t,e,n){var i,r,s;e.children.length>1&&!e.sliding&&(n.ox=n.nx,n.ot=n.nt,n.nx=t.x,n.nt=t.domEvent.timeStamp,!e.moving&&Math.abs(n.nx-n.x)>e.minVal&&(e.moving=!0,n.sl()),e.moving&&(i=n.nx-n.x,r=n.nx>n.x?Math.floor(i/e.container.clientWidth):Math.ceil(i/e.container.clientWidth),i%=e.container.clientWidth,0===r?r=e.current:(n.x+=r*e.container.clientWidth,r=h(e.current-r,e.children.length)),s=0===i?r:h(i>0?r-1:r+1,e.children.length),e.children[r]!==e.subcontainer.firstChild&&e.children[s]!==e.subcontainer.firstChild&&e.invisible.appendChild(e.subcontainer.firstChild),e.subcontainer.lastChild&&e.children[r]!==e.subcontainer.lastChild&&e.children[s]!==e.subcontainer.lastChild&&e.invisible.appendChild(e.subcontainer.lastChild),e.children[r].parentNode!==e.subcontainer&&(e.subcontainer.childNodes.length>0&&0>i?e.subcontainer.insertBefore(e.children[r],e.children[s]):e.subcontainer.appendChild(e.children[r])),i>0?(e.subcontainer.firstChild!==e.children[s]&&e.subcontainer.insertBefore(e.children[s],e.children[r]),e.subcontainer.style.left=i-e.container.clientWidth+"px"):0>i?(e.subcontainer.lastChild!==e.children[s]&&e.subcontainer.appendChild(e.children[s]),e.subcontainer.style.left=i+"px"):e.subcontainer.style.left=0,r!==e.current&&(e.current=r,a(e,"change")))),e.moving&&t.domEvent.preventDefault()}function s(t,n,i){var r,s;2===n.subcontainer.childNodes.length?(r=(t.x-i.ox)/(t.domEvent.timeStamp-i.ot),s=Math.pow(r,2)*n.rate,0>r&&(s=-1*s),n.children[n.current]===n.subcontainer.firstChild?n.subcontainer.offsetLeft+s<n.container.offsetWidth*-.5?(e(n,!1),n.current=h(n.current+1,n.children.length),a(n,"change")):e(n,!0):n.subcontainer.offsetLeft+s>n.container.offsetWidth*-.5?(e(n,!0),n.current=h(n.current-1,n.children.length),a(n,"change")):e(n,!1)):d(n),c(n,i)}function o(t,n){2===t.subcontainer.childNodes.length?e(t,t.children[t.current]===t.subcontainer.firstChild):d(t),c(t,n)}function c(t,e){t.moving?t.moving=!1:e.sl&&e.sl()}function h(t,e){var n=t%e;return 0>n&&(n+=e),n}function a(t,e){var n="on"+e;"function"==typeof t[n]&&t[n]({type:e})}function l(t){t.preventDefault()}function d(t){t.delay&&(t.timer=setTimeout(function(){delete t.timer,t.slideTo(t.current+1)},t.delay))}function u(t){t.target===this&&(this.scrollLeft=this.scrollTop=0)}var f,p,g;return"transition"in document.documentElement.style?(g="transition",p="transitionend"):(g="webkitTransition",p="webkitTransitionEnd"),f=function(e,r,s){function o(t){return i(t,d,a,g)}function c(t){d.sliding&&(t.preventDefault(),t.stopPropagation())}if(!(this instanceof f))return new f(e);var h,a,d=this,g={};if(this.pushStack=[],this.removeStack=[],e?(this.container=e,"static"===getComputedStyle(e).position&&(e.style.position="relative")):(this.container=document.createElement("div"),this.container.style.position="relative"),this.container.style.overflow="hidden",this.container.style.userSelect="none",this.invisible=this.container.appendChild(document.createElement("div")),this.invisible.style.position="absolute",this.invisible.style.visibility="hidden",this.subcontainer=this.container.appendChild(document.createElement("div")),this.subcontainer.style.position="absolute",this.subcontainer.style.width="200%",this.subcontainer.style.height="100%",this.subcontainer.style.left=0,this.subcontainer.addEventListener(p,function(t){n.call(this,t,d)},!1),this.container.addEventListener("dragstart",l,!1),this.container.addEventListener("scroll",u,!1),this.container.addEventListener("click",c,!0),a=t(this.container,o),r instanceof Array&&r.length>0)for(this.children=r,"number"==typeof s&&s>=0&&s<r.length?this.current=s:this.current=0,h=0;h<r.length;h++)r[h].style.width="50%",r[h].style.height="100%",r[h].style.display="inline-block",h===this.current?this.subcontainer.appendChild(r[h]):this.invisible.appendChild(r[h]);else this.current=void 0,this.children=[]},f.prototype.rate=4e3,f.prototype.duration=400,f.prototype.minVal=5,f.prototype.add=function(t){var e;return this.sliding?this.pushStack.push(t):(e=this.children.length,t.style.width="50%",t.style.height="100%",t.style.display="inline-block",this.children.push(t),0===e?(this.subcontainer.appendChild(t),this.current=0,a(this,"change")):2===this.subcontainer.childNodes.length?this.current===e-1&&this.subcontainer.firstChild===this.children[this.current]?(this.invisible.appendChild(this.subcontainer.firstChild),this.subcontainer.insertBefore(t,this.subcontainer.lastChild)):0===this.current&&this.subcontainer.lastChild===this.children[this.current]?(this.invisible.appendChild(this.subcontainer.lastChild),this.subcontainer.appendChild(t)):this.invisible.appendChild(t):this.invisible.appendChild(t)),e},f.prototype.remove=function(t){var e;return this.sliding?this.removeStack.push("number"==typeof t?this.children[t]:t):this.children.length>0&&("number"!=typeof t&&(t=this.children.indexOf(t)),t=h(t,this.children.length),e=this.children.splice(t,1)[0],this.current===t?(2===this.subcontainer.childNodes.length?this.children.length>1?e===this.subcontainer.firstChild?(this.current=h(t-1,this.children.length),this.subcontainer.insertBefore(this.children[this.current],e)):(this.current=h(t,this.children.length),this.subcontainer.appendChild(this.children[this.current])):(this.current=0,this.subcontainer.style.left=0):this.children.length>0?(this.current=h(t,this.children.length),this.subcontainer.appendChild(this.children[this.current])):this.current=void 0,this.subcontainer.removeChild(e),a(this,"change")):(e.parentNode===this.subcontainer?(this.children.length>1?e===this.subcontainer.firstChild?this.subcontainer.insertBefore(this.children[h(t-1,this.children.length)],e):this.subcontainer.appendChild(this.children[h(t,this.children.length)]):(this.subcontainer.removeChild(e),this.subcontainer.style.left=0),this.subcontainer.removeChild(e)):this.invisible.removeChild(e),this.current>t&&(this.current-=1,a(this,"change")))),e},f.prototype.slideTo=function(t,n){var i;return 1===this.subcontainer.childNodes.length&&this.children.length>1?(t=h(t,this.children.length),t!==this.current&&(n?(this.invisible.appendChild(this.children[this.current]),this.subcontainer.appendChild(this.children[t])):0===t&&this.current===this.children.length-1||t>this.current?(this.subcontainer.appendChild(this.children[t]),e(this,!1)):(this.subcontainer.insertBefore(this.children[t],this.children[this.current]),this.subcontainer.style.left="-100%",e(this,!0)),this.current=t,a(this,"change")),i=!0):i=!1,i},f.prototype.startPlay=function(t){this.stopPlay(),this.delay=t,d(this)},f.prototype.stopPlay=function(){var t;return this.delay?(delete this.delay,this.timer&&(clearTimeout(this.timer),delete this.timer),t=!0):t=!1,t},f});