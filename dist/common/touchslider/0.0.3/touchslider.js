"use strict";define("common/touchslider/touchslider",["common/pointerevents/pointerevents"],function(e){function t(e,t){var n,i;t?(n=Math.round(Math.sqrt(-1*e.subcontainer.offsetLeft/e.container.clientWidth)*e.duration),i=0):(n=Math.round(Math.sqrt((e.container.offsetWidth+e.subcontainer.offsetLeft)/e.container.clientWidth)*e.duration),i="-100%"),n>0?(e.sliding=!0,e.subcontainer.style[y]="left "+n+"ms ease-in-out",e.subcontainer.style.left=i):h(e)}function n(e,t){if(e.target===this){for(t.invisible.appendChild("-100%"===this.style.left?this.firstChild:this.lastChild),this.style[y]="",this.style.left=0,t.sliding=!1;t.removeStack.length>0;)t.remove(t.removeStack.shift());for(;t.pushStack.length>0;)t.add(t.pushStack.shift());c(t,"slidend"),h(t)}}function i(e,t,n,i){if("start"===e.type){if(!n.pointers.length&&t.children.length>1&&!t.sliding)return t.timer&&(clearTimeout(t.timer),delete t.timer),i.ox=i.nx=i.x=e.x,i.ot=i.nt=e.domEvent.timeStamp,i.sl=function(e){document.removeEventListener("scroll",i.sl,!0),delete i.sl},document.addEventListener("scroll",i.sl,!0),!0}else(t.moving||i.sl)&&("move"===e.type?o(e,t,i):"end"===e.type?s(e,t,i):l(t,i))}function o(e,t,n){var i,o,s;t.children.length>1&&!t.sliding&&(n.ox=n.nx,n.ot=n.nt,n.nx=e.x,n.nt=e.domEvent.timeStamp,!t.moving&&Math.abs(n.nx-n.x)>t.minVal&&(t.moving=!0,n.sl()),t.moving&&(i=n.nx-n.x,o=n.nx>n.x?Math.floor(i/t.container.clientWidth):Math.ceil(i/t.container.clientWidth),i%=t.container.clientWidth,0===o?o=t.current:(n.x+=o*t.container.clientWidth,o=a(t.current-o,t.children.length)),s=0===i?o:a(i>0?o-1:o+1,t.children.length),t.children[o]!==t.subcontainer.firstChild&&t.children[s]!==t.subcontainer.firstChild&&t.invisible.appendChild(t.subcontainer.firstChild),t.subcontainer.lastChild&&t.children[o]!==t.subcontainer.lastChild&&t.children[s]!==t.subcontainer.lastChild&&t.invisible.appendChild(t.subcontainer.lastChild),t.children[o].parentNode!==t.subcontainer&&(t.subcontainer.childNodes.length>0&&0>i?t.subcontainer.insertBefore(t.children[o],t.children[s]):t.subcontainer.appendChild(t.children[o])),i>0?(t.subcontainer.firstChild!==t.children[s]&&t.subcontainer.insertBefore(t.children[s],t.children[o]),t.subcontainer.style.left=i-t.container.clientWidth+"px"):0>i?(t.subcontainer.lastChild!==t.children[s]&&t.subcontainer.appendChild(t.children[s]),t.subcontainer.style.left=i+"px"):t.subcontainer.style.left=0,o!==t.current&&(t.current=o,c(t,"change",{current:!0})))),t.moving&&e.domEvent.preventDefault()}function s(e,n,i){var o,s;2===n.subcontainer.childNodes.length?(o=(e.x-i.ox)/(e.domEvent.timeStamp-i.ot),s=Math.pow(o,2)*n.rate,0>o&&(s=-1*s),n.children[n.current]===n.subcontainer.firstChild?n.subcontainer.offsetLeft+s<n.container.offsetWidth*-.5?(t(n,!1),n.current=a(n.current+1,n.children.length),c(n,"change",{current:!0})):t(n,!0):n.subcontainer.offsetLeft+s>n.container.offsetWidth*-.5?(t(n,!0),n.current=a(n.current-1,n.children.length),c(n,"change",{current:!0})):t(n,!1)):h(n),r(n,i)}function l(e,n){2===e.subcontainer.childNodes.length?t(e,e.children[e.current]===e.subcontainer.firstChild):h(e),r(e,n)}function r(e,t){e.moving?e.moving=!1:t.sl&&t.sl()}function a(e,t){var n=e%t;return 0>n&&(n+=t),n}function c(e,t,n){var i,o="on"+t;"function"==typeof e[o]&&(i=e[o]({type:t,__proto__:n}))}function d(e){e.preventDefault()}function h(e){e.delay&&(e.timer=setTimeout(function(){delete e.timer,e.slideTo(e.current+1)},e.delay))}function u(e){e.target===this&&(this.scrollLeft=this.scrollTop=0)}var f,p,y;return"transition"in document.documentElement.style?(y="transition",p="transitionend"):(y="webkitTransition",p="webkitTransitionEnd"),f=function(t,o,s){function l(e){return i(e,h,c,y)}function r(e){h.sliding&&(e.preventDefault(),e.stopPropagation())}if(!(this instanceof f))return new f(t);var a,c,h=this,y={};if(this.pushStack=[],this.removeStack=[],t?(this.container=t,"static"===getComputedStyle(t).position&&(t.style.position="relative")):(this.container=document.createElement("div"),this.container.style.position="relative"),this.container.style.overflow="hidden",this.container.style.userSelect="none",this.invisible=this.container.appendChild(document.createElement("div")),this.invisible.style.position="absolute",this.invisible.style.visibility="hidden",this.subcontainer=this.container.appendChild(document.createElement("div")),this.subcontainer.style.position="absolute",this.subcontainer.style.width="200%",this.subcontainer.style.height="100%",this.subcontainer.style.left=this.subcontainer.style.top=0,this.subcontainer.addEventListener(p,function(e){n.call(this,e,h)},!1),this.container.addEventListener("dragstart",d,!1),this.container.addEventListener("scroll",u,!1),this.container.addEventListener("click",r,!0),c=e(this.container,l),o instanceof Array&&o.length>0)for(this.children=o,"number"==typeof s&&s>=0&&s<o.length?this.current=s:this.current=0,a=0;a<o.length;a++)o[a].style.width="50%",o[a].style.height="100%",o[a].style.display="inline-block",a===this.current?this.subcontainer.appendChild(o[a]):this.invisible.appendChild(o[a]);else this.current=void 0,this.children=[]},f.prototype.rate=4e3,f.prototype.duration=400,f.prototype.minVal=5,f.prototype.add=function(e){var t;return this.sliding?this.pushStack.push(e):(t=this.children.length,e.style.width="50%",e.style.height="100%",e.style.display="inline-block",this.children.push(e),t?(2===this.subcontainer.childNodes.length?this.current===t-1&&this.subcontainer.firstChild===this.children[this.current]?(this.invisible.appendChild(this.subcontainer.firstChild),this.subcontainer.insertBefore(e,this.subcontainer.lastChild)):0===this.current&&this.subcontainer.lastChild===this.children[this.current]?(this.invisible.appendChild(this.subcontainer.lastChild),this.subcontainer.appendChild(e)):this.invisible.appendChild(e):this.invisible.appendChild(e),c(this,"change",{length:!0})):(this.subcontainer.appendChild(e),this.current=0,c(this,"change",{current:!0,length:!0}))),t},f.prototype.remove=function(e){var t;return this.sliding?("number"==typeof e&&(e=this.children[e]),this.removeStack.indexOf(e)<0&&this.removeStack.push(e)):this.children.length>0&&("number"!=typeof e&&(e=this.children.indexOf(e)),e=a(e,this.children.length),t=this.children.splice(e,1)[0],this.current===e?(2===this.subcontainer.childNodes.length?this.children.length>1?t===this.subcontainer.firstChild?(this.current=a(e-1,this.children.length),this.subcontainer.insertBefore(this.children[this.current],t)):(this.current=a(e,this.children.length),this.subcontainer.appendChild(this.children[this.current])):(this.current=0,this.subcontainer.style.left=0):this.children.length>0?(this.current=a(e,this.children.length),this.subcontainer.appendChild(this.children[this.current])):this.current=void 0,this.subcontainer.removeChild(t),c(this,"change",{current:!0,length:!0})):(t.parentNode===this.subcontainer?(this.children.length>1?t===this.subcontainer.firstChild?this.subcontainer.insertBefore(this.children[a(e-1,this.children.length)],t):this.subcontainer.appendChild(this.children[a(e,this.children.length)]):(this.subcontainer.removeChild(t),this.subcontainer.style.left=0),this.subcontainer.removeChild(t)):this.invisible.removeChild(t),this.current>e?(this.current-=1,c(this,"change",{current:!0,length:!0})):c(this,"change",{length:!0}))),t},f.prototype.clear=function(){if(this.sliding)this.removeStack=this.children.slice(0),this.pushStack=[];else for(;this.children.length;)this.remove(0)},f.prototype.slideTo=function(e,n){var i;return 1===this.subcontainer.childNodes.length&&this.children.length>1?(e=a(e,this.children.length),e!==this.current&&(n?(this.invisible.appendChild(this.children[this.current]),this.subcontainer.appendChild(this.children[e])):0===e&&this.current===this.children.length-1||e>this.current?(this.subcontainer.appendChild(this.children[e]),t(this,!1)):(this.subcontainer.insertBefore(this.children[e],this.children[this.current]),this.subcontainer.style.left="-100%",t(this,!0)),this.current=e,c(this,"change",{current:!0})),i=!0):i=!1,i},f.prototype.startPlay=function(e){this.stopPlay(),this.delay=e,h(this)},f.prototype.stopPlay=function(){var e;return this.delay?(delete this.delay,this.timer&&(clearTimeout(this.timer),delete this.timer),e=!0):e=!1,e},f});