"use strict";define(["common/pointerevents/pointerevents"],function(t){function e(t,e,y){var a;if("start"===e.type){if(y.length<2)return a={id:e.id,x:e.x,y:e.y},y.push(a),1===y.length?r(t,"dragstart",{x:y[0].x,y:y[0].y}):(a.l=Math.sqrt(Math.pow(e.x-y[0].x,2)+Math.pow(e.y-y[0].y,2)),r(t,"dragend",{x:y[0].x,y:y[0].y}),r(t,"zoomstart",{x:(y[0].x+y[1].x)/2,y:(y[0].y+y[1].y)/2})),!0}else"move"===e.type?n(t,e,y):o(t,e,y)}function n(t,e,n){var o=0;e.domEvent.preventDefault(),e.domEvent.stopPropagation(),1===n.length?e.id===n[0].id&&(n[0].x=e.x,n[0].y=e.y,r(t,"dragmove",{x:n[0].x,y:n[0].y})):(n[o=e.id===n[0].id?0:1].x=e.x,n[o].y=e.y,r(t,"zoomchange",{zoom:Math.sqrt(Math.pow(n[1].x-n[0].x,2)+Math.pow(n[1].y-n[0].y,2))/n[1].l}))}function o(t,e,n){var o;2===n.length?(n[o=e.id===n[0].id?0:1].x=e.x,n[o].y=e.y,r(t,"zoomend",{zoom:Math.sqrt(Math.pow(n[1].x-n[0].x,2)+Math.pow(n[1].y-n[0].y,2))/n[1].l}),n.splice(o,1),delete n[0].l,r(t,"dragstart",{x:n[0].x,y:n[0].y})):(n.pop(),r(t,"dragend",{x:e.x,y:e.y}))}function r(t,e,n){var o="on"+e;"function"==typeof t[o]&&(n||(n={}),n.type=e,t[o](n))}var y=function(n){var o,r;if(!(this instanceof y))return new y(n);o=this,r=[],this.destory=t(n,function(t){return e(o,t,r)}).destory};return y});